%% -*- LaTeX -*-
%%
%% LaTeX file for mathematical extensions and support macros
%% Needs AMS-Math to work correct.
%
%% Copyright (C) 2003-2010 Ralf Hoppe
%%
%% $Id$
%%
%% History:
%% $Log: not supported by cvs2svn $
%% Revision 1.11  2009-03-15 15:40:29  ralf
%% new functions lcm and totient
%%
%% Revision 1.10  2008-11-30 14:06:15  ralf
%% adjustment to LyX 1.6.0
%%
%%



%% Macros and Definitions
%%

\usepackage{array}                      %% needed for \extrarowheight and \jot
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{amsopn,amsfonts}            %% do not include amsthm -> collision w/ svjour
\usepackage{trfsigns}                   %% symbols for FT, LT and e

\addtolength{\extrarowheight}{2pt}      %% extra vertical space in array (tabular family) environment
\addtolength{\jot}{2pt}                 %% extra vertical space in eqnarray environment


\floatname{algorithm}{Algorithmus}      %% from algorithm package


%%%%%%%%%%%%%%%%% New commands

\newcommand{\tabvstretch} {\renewcommand{\arraystretch}{1.5}} % table/array vertical stretching
\newcommand{\tabvnormal}  {\renewcommand{\arraystretch}{1.0}} % reset to default

\newcommand{\mbig} [1] {\displaystyle{#1}}

%% Fractions look extremely ugly in tables, because there is no space over
%% and under. The following macro writes a fbox without a frame but with the
%% fboxsep. But this does not work on some HTML converters.
\@ifpackageloaded{tex4ht.sty}{  % math in tables
  \newcommand{\mtab} [1] {      %
    \ensuremath{\mbig{#1}}}}{
  \newcommand{\mtab} [1] {      %
    \setlength{\fboxrule}{0pt}  %
    \fbox{\ensuremath{\mbig{#1}}}}}

\newcommand{\mboxed} [1] {\boxed{#1}}
\newcommand{\mvec} [1] {\ensuremath{\mathbf{#1}}} % Bold matrix/vector
\newcommand{\mdet} [1] {\mvec{#1}} % determinant variable
%% \newcommand{\mequiv} {\ensuremath{\mathrel{\widehat{=}}}} %% equivalent: = with hat
\newcommand{\mequiv} {\ensuremath{\stackrel{\scriptscriptstyle\wedge}{=}}} %% equivalent: = with hat

\newcommand{\ji} {\im}               %% j from package trfsigns
\newcommand{\vp} {\,\textup{V.\,P.}} %% Cauchy principal value


%% Optional superscript if exponent is unequal to zero
%% Requires \usepackage{ifthen}
%% Example: \optsup {0}{x} displays "x", \optsup {n}{x} displays "x^n"
\newcommand{\optsup} [2] {{#2} \ifthenelse{\equal{#1}{0}}{\mbox{}}{^{#1}}}

%% Assigns a value to variable (used in algorithms)
\newcommand{\assign} [2] {\ensuremath{{#1} \Leftarrow \mbig{#2}}} % variable := value

\newcommand{\incircle} [1] {\ensuremath{\mathbin{\settowidth{\dimen6}{\mbox{$\bigcirc$}}%
              \makebox[0pt][l]{$\bigcirc$}\makebox[\dimen6]{\small{#1}}}}}

\newcommand{\msp} {\ensuremath{\;}}% math space
\newcommand{\mperiod} {\msp.}      % period (at end of sentence) in math mode


%% Partial and total derivations and the used >>d<< character
\newcommand{\pdc} {\partial}       % partial differential character
\newcommand{\tdc} {\textup{d}}     % total differential character
\newcommand{\pic} {\,\pdc}         % partial differential with leading (thin) space
\newcommand{\tic} {\,\tdc}         % total differential with leading (thin) space
\newcommand{\pdiff} [3] [0] {\frac{\optsup{#1}{\pdc} #2}{\pdc \optsup{#1}{#3}}}
\newcommand{\tdiff} [3] [0] {\frac{\optsup{#1}{\tdc} #2}{\tdc \optsup{#1}{#3}}}


%%%%%%%%%%%%%%%%% Parameters of elliptic integrals and functions

\newcommand{\tpar} [3] {#1;\, #2; #3}
\newcommand{\epar} [2] {#1;\, #2}
\newcommand{\spar} [1] {#1}


%%%%%%%%%%%%%%%%% New functions


%% \DeclareMathOperator{\imop}{\Im}
\DeclareMathOperator{\imop}{Im}         %% Imaginary part of complex number (Im{} operator)
%% \DeclareMathOperator{\reop}{\Re}
\DeclareMathOperator{\reop}{Re}         %% real part of complex number (Re{} operator)
\DeclareMathOperator{\ang}{\measuredangle}    %% angle of a complex number
%% \DeclareMathOperator{\ang}{\angle}   %% angle of a complex number
%% \DeclareMathOperator{\ang}{\arg}     %% angle of a complex number
\DeclareMathOperator{\residue}{res}     %% residue
\DeclareMathOperator{\expf}{e}          %% Exponential function


%% Conjugate complexe value of a variable, function or expression
%% 
%% When the first (optional) argument is missing then the second will be
%% completely indicated as a conjugate complex value. When there is a
%% first argument then the second will be assumed as a function parameter.
%% In that case only the first argument is indicated as a conjugate complex
%% value and the second is shown only in normal parenthesis.


\newcommand{\cjgt} [2] [empty] {%
  \def\tempa{empty}%
  \def\tempb{#1}%
  \ifx\tempb\tempa
    #2^\ast%
  \else
    #1^\ast(#2)%
  \fi
}


%% \newcommand{\cjgt} [2] [] {%
%%   \ifx\\#1\\%
%%     \overline{#2}%
%%   \else
%%     \overline{#1(#2)}%
%%   \fi
%% }


\newcommand{\res} [2] {\residue_{#1} {#2}}  %% residue of function #2 at point #1

%% Simple Polynomial
%% Example: \poly{a}{x}{n} defines a polynomial in x with coefficients a[i]
%% from i=0 to i=n

\newcommand {\poly} [3] {\ensuremath{{#1}_{#3}{#2}^{#3}+\cdots +{#1}_2 {#2}^2+{#1}_1 {#2}+{#1}_0}}

%% Basic functions

\DeclareMathOperator{\sign}{sign}       %% Sign of an expression
\DeclareMathOperator{\cosec}{cosec}     %% 1/sin(x)
\DeclareMathOperator{\sech}{sech}       %% 1/cosh(x)
\DeclareMathOperator{\arsinh}{arsinh}
\DeclareMathOperator{\arcosh}{arcosh}
\DeclareMathOperator{\artanh}{artanh}
\DeclareMathOperator{\ld}{\log_{2}}     %% logaritmus dualis (ld)
\DeclareMathOperator{\gd}{gd}           %% Guderman function gd(x) = arctan(sinh(x))

%% Probability
\newcommand{\avg} [1] {\overline{#1}}   %% Average (in German >>Mittelwert<<)
\DeclareMathOperator{\pr}{\Pr}          %% Probability (sometimes only P)
\DeclareMathOperator{\cnorm}{\Phi}      %% Normal (cummulative) distribution
\DeclareMathOperator{\mean}{E}          %% Expected value (operator)
\DeclareMathOperator{\var}{Var}         %% Variance, e.g. \var X
\DeclareMathOperator{\cov}{Cov}         %% Covariance
\DeclareMathOperator{\corr}{Corr}       %% Correlation coefficient


%% Algebraic functions
\DeclareMathOperator{\lcm}{lcm}         %% Least Common Multiplier
\DeclareMathOperator{\ord}{ord}         %% Order
\DeclareMathOperator{\GF}{GF}           %% Galois field
\DeclareMathOperator{\MONTG}{M}         %% Montgomery transformation
\DeclareMathOperator{\totient}{\phi}    %% Euler's totient function
\newcommand{\rcls} [2] {{\left[ {#1} \right] }_{#2}} % residue class

%% Logic
\DeclareMathOperator{\rol}{rol}         %% Rotate Left
\DeclareMathOperator{\ror}{ror}         %% Rotate Right
\DeclareMathOperator{\shl}{shl}         %% Shift Left
\DeclareMathOperator{\shr}{shr}         %% Shift Right


%% Chebyshev functions (polynomials)
\DeclareMathOperator{\Tn}{T}
\DeclareMathOperator{\Un}{U}
\DeclareMathOperator{\sinc}{sinc}       %% sinc(x) = sin(x)/x


%% Arithmetic Geometric Mean (AGM)
\DeclareMathOperator{\AGM}{M}


\DeclareMathOperator{\jK}{K}


%% Preliminaries for Jacobian elliptic functions
%% note: \the\epqheight prints the height value
\newlength{\epqheight}
\newlength{\epqlimit}
\settoheight{\epqlimit}{\ensuremath{\epar{\ji\xi/2+\jK'}{k'}}}
\newsavebox{\epqbox}

%% Basic definition for abstract Jacobian elliptic function pq
%% 1. arg: exponent
%% 2. arg: name
%% 3. arg: argument
%% 4. arg: module (k)

\newcommand{\epq} [4] {%
  \savebox{\epqbox}{\ensuremath{\epar{#3}{#4}}}
  \settoheight{\epqheight}{\usebox{\epqbox}}
  \optsup{#1}{#2}%
  \ifthenelse{\lengthtest{\epqheight > \epqlimit}}%
             {\left(\usebox{\epqbox}\right)}%
             {(\usebox{\epqbox})}%
}


\newcommand{\exarg} [1] {\underset{{}^{\scriptscriptstyle{\star}}}{#1}}


%% all Jacobian elliptic functions

\DeclareMathOperator{\jam}{am}
\DeclareMathOperator{\jdelta}{\varDelta} % delta-amplitude
\DeclareMathOperator{\jsn}{sn}
\DeclareMathOperator{\jcn}{cn}
\DeclareMathOperator{\jdn}{dn}
\DeclareMathOperator{\jcd}{cd}
\DeclareMathOperator{\jdc}{dc}
\DeclareMathOperator{\jsc}{sc}
\DeclareMathOperator{\jnc}{nc}
\DeclareMathOperator{\jds}{ds}
\DeclareMathOperator{\jcs}{cs}
\DeclareMathOperator{\jsd}{sd}
\DeclareMathOperator{\jns}{ns}
\DeclareMathOperator{\jnd}{nd}

%% Example \edc [2]{u}{k}
%%         \edc {u}{k}

\newcommand{\efunc} [4] [0] {\epq{#1}{#2}{#3}{#4}} % general elliptic function

\newcommand{\esn} [3] [0] {\epq{#1}{\jsn}{#2}{#3}}
\newcommand{\ecn} [3] [0] {\epq{#1}{\jcn}{#2}{#3}}
\newcommand{\edn} [3] [0] {\epq{#1}{\jdn}{#2}{#3}}
\newcommand{\ecd} [3] [0] {\epq{#1}{\jcd}{#2}{#3}}
\newcommand{\edc} [3] [0] {\epq{#1}{\jdc}{#2}{#3}}
\newcommand{\esc} [3] [0] {\epq{#1}{\jsc}{#2}{#3}}
\newcommand{\enc} [3] [0] {\epq{#1}{\jnc}{#2}{#3}}
\newcommand{\eds} [3] [0] {\epq{#1}{\jds}{#2}{#3}}
\newcommand{\ecs} [3] [0] {\epq{#1}{\jcs}{#2}{#3}}
\newcommand{\esd} [3] [0] {\epq{#1}{\jsd}{#2}{#3}}
\newcommand{\ens} [3] [0] {\epq{#1}{\jns}{#2}{#3}}
\newcommand{\ejnd} [3] [0] {\epq{#1}{\jnd}{#2}{#3}} % \end is reserved by LaTeX

\newcommand{\eam} [3] [0] {\epq{#1}{\jam}{#2}{#3}}

\newcommand{\edelta} [3] [0] {\epq{#1}{\jdelta}{#2}{#3}}


%% Complete Elliptic Integral

\newcommand{\eK} [2] [0] { \optsup{#1}{\jK} \left(\spar{#2}\right)}


%% Incomplete Elliptic Integral

\DeclareMathOperator{\ellF}{F}
\DeclareMathOperator{\ellxF}{\exarg{\ellF}}
\DeclareMathOperator{\ellE}{E}
\DeclareMathOperator{\ellPi}{\Pi}

\newcommand{\eF} [3] [0] {\epq{#1}{\ellF}{#2}{#3}}       %% Legendre form F(phi; k)
\newcommand{\exF} [3] [0] {\epq{#1}{\ellxF}{#2}{#3}}     %% F(x; k)
\newcommand{\eE} [3] [0] {\epq{#1}{\ellE}{#2}{#3}}       %% E(phi; k)
\newcommand{\ePi} [3] {\ellPi (\tpar{#1}{#2}{#3})}



%% Zolotarev's function

\DeclareMathOperator{\Z}{Z}
\newcommand{\Zo} [3] [0] {\epq{#1}{\Z}{#2}{#3}}



%% Poles and Zeroes

\ifx\opentimes\undefined %% \opentimes from px/txfonts packages loaded?
  \def\opentimes{\times}
\fi

\newcommand{\zn} [3] [0] {\optsup{#1}{{#2}\kern-.24em\lower.68ex\hbox{$\scriptscriptstyle\circ$}}_{#3}}
%% \newcommand{\zn} [3] [0] {\optsup{#1}{{#2}_{\! \scriptscriptstyle \circ}}_{#3}}
\newcommand{\pn} [3] [0] {\optsup{#1}{{#2}\kern-.24em\lower.68ex\hbox{$\scriptscriptstyle\opentimes$}}_{#3}}
%% \newcommand{\pn} [3] [0] {\optsup{#1}{{#2}_{\! \scriptscriptstyle \infty}}_{#3}}


%% Integral transformations (FT, LT, ZT, DFT, ...) and \e, \im from trfsigns
\DeclareMathOperator{\ft} {\mathcal F}  %% Fourier-Transform
\DeclareMathOperator{\lt} {\mathcal L}  %% Laplace-Transform
\DeclareMathOperator{\zt} {\mathcal Z}  %% Z-Transform

\newcommand{\lft} [1] [] {\allowbreak\;\laplace{#1}\allowbreak\;}    %% Continuous Fourier transform (left time domain)
\newcommand{\rft} [1] [] {\allowbreak\;\Laplace{#1}\allowbreak\;}    %% Continuous Fourier transform (right time domain)
\newcommand{\lpt} [1] [] {\allowbreak\;\laplace{#1}\allowbreak\;}    %% Continuous Laplace transform (left time domain)
\newcommand{\rlt} [1] [] {\allowbreak\;\Laplace{#1}\allowbreak\;}    %% Continuous Laplace transform (right time domain)


%% Inline math in headings/titles (no replacement per default)
%% Usage: \headingmath{expr}{replacement}
%% Example: \headingmath{x^y}{x times y}
\providecommand{\headingmath} [2] {\ensuremath{#1}}
